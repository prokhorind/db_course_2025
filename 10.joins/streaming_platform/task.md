# üé¨ –ü—Ä–∞–∫—Ç–∏—á–Ω–∞ —Ä–æ–±–æ—Ç–∞: INNER JOIN  
## –¢–µ–º–∞: –°—Ç—Ä—ñ–º—ñ–Ω–≥–æ–≤–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞

–ú–∏ –ø—Ä–∞—Ü—é—î–º–æ –∑—ñ —Å—Ö–µ–º–æ—é:

    streaming_platform

–£ –±–∞–∑—ñ —î 3 —Ç–∞–±–ª–∏—Ü—ñ:

- users ‚Äî –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏  
- movies ‚Äî —Ñ—ñ–ª—å–º–∏  
- watch_history ‚Äî —ñ—Å—Ç–æ—Ä—ñ—è –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤  

–ü–µ—Ä–µ–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º –∑–∞–≤–¥–∞–Ω—å –≤–∏–∫–æ–Ω–∞–π—Ç–µ:

SET search_path TO streaming_platform;

---

# üìå –ó–∞–≤–¥–∞–Ω–Ω—è 1  
## –•—Ç–æ —â–æ –¥–∏–≤–∏–≤—Å—è?

–í–∏–≤–µ–¥—ñ—Ç—å —Å–ø–∏—Å–æ–∫, —è–∫–∏–π –ø–æ–∫–∞–∑—É—î:

- username  
- –Ω–∞–∑–≤—É —Ñ—ñ–ª—å–º—É  
- –∂–∞–Ω—Ä —Ñ—ñ–ª—å–º—É  

–£ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –∫–æ–∂–µ–Ω —Ä—è–¥–æ–∫ –ø–æ–≤–∏–Ω–µ–Ω –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏:
"–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á ‚Äî –§—ñ–ª—å–º ‚Äî –ñ–∞–Ω—Ä"

–ü—ñ–¥–∫–∞–∑–∫–∞: –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–±'—î–¥–Ω–∞—Ç–∏ –≤—Å—ñ —Ç—Ä–∏ —Ç–∞–±–ª–∏—Ü—ñ —á–µ—Ä–µ–∑ INNER JOIN.

---

# üìå –ó–∞–≤–¥–∞–Ω–Ω—è 2  
## –ü–µ—Ä–µ–≥–ª—è–¥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

–ü–æ–∫–∞–∂—ñ—Ç—å —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö —Ñ—ñ–ª—å–º—ñ–≤, —è–∫—ñ –¥–∏–≤–∏–≤—Å—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á:

    oleh

–í–∏–≤–µ—Å—Ç–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ:

- –Ω–∞–∑–≤—É —Ñ—ñ–ª—å–º—É  
- –¥–∞—Ç—É –ø–µ—Ä–µ–≥–ª—è–¥—É  

---

# üìå –ó–∞–≤–¥–∞–Ω–Ω—è 3  
## –°–µ—Ä–µ–¥–Ω—è –æ—Ü—ñ–Ω–∫–∞ —Ñ—ñ–ª—å–º—ñ–≤

–î–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ñ—ñ–ª—å–º—É –≤–∏–∑–Ω–∞—á—Ç–µ –π–æ–≥–æ —Å–µ—Ä–µ–¥–Ω—é –æ—Ü—ñ–Ω–∫—É.

–í–∏–≤–µ—Å—Ç–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ:

- –Ω–∞–∑–≤—É —Ñ—ñ–ª—å–º—É  
- —Å–µ—Ä–µ–¥–Ω—é –æ—Ü—ñ–Ω–∫—É (avg_rating)

–û–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏:
- AVG()
- GROUP BY

---

# üìå –ó–∞–≤–¥–∞–Ω–Ω—è 4  
## –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ –æ—Ü—ñ–Ω–∫–∏

–ó–Ω–∞–π–¥—ñ—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —è–∫—ñ –ø–æ—Å—Ç–∞–≤–∏–ª–∏ –æ—Ü—ñ–Ω–∫—É:

    10

–í–∏–≤–µ—Å—Ç–∏:

- username  
- –Ω–∞–∑–≤—É —Ñ—ñ–ª—å–º—É  
- –æ—Ü—ñ–Ω–∫—É  

---

# üìå –ó–∞–≤–¥–∞–Ω–Ω—è 5  
## –ü–æ–ø—É–ª—è—Ä–Ω—ñ—Å—Ç—å —Ñ—ñ–ª—å–º—ñ–≤

–ü–æ—Ä–∞—Ö—É–π—Ç–µ, —Å–∫—ñ–ª—å–∫–∏ —Ä–∞–∑—ñ–≤ –∫–æ–∂–µ–Ω —Ñ—ñ–ª—å–º –±—É–≤ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏–π.

–í–∏–≤–µ—Å—Ç–∏:

- –Ω–∞–∑–≤—É —Ñ—ñ–ª—å–º—É  
- –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤  

–û–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏:
- COUNT()
- GROUP BY

---

# ‚≠ê –î–æ–¥–∞—Ç–∫–æ–≤–µ –∑–∞–≤–¥–∞–Ω–Ω—è (–¥–ª—è —Å–∏–ª—å–Ω—ñ—à–∏—Ö —É—á–Ω—ñ–≤)

–ó–Ω–∞–π–¥—ñ—Ç—å —Ñ—ñ–ª—å–º –∑ –Ω–∞–π–±—ñ–ª—å—à–æ—é —Å–µ—Ä–µ–¥–Ω—å–æ—é –æ—Ü—ñ–Ω–∫–æ—é.

–ü—ñ–¥–∫–∞–∑–∫–∞: –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏:
- ORDER BY
- LIMIT 1

# –ü—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –≤–∏–∫–æ–Ω–∞–π—Ç–µ:

 - SET search_path TO public; 
 - –¶–µ –ø–æ–≤–µ—Ä–Ω–µ –≤–∞—Å –¥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—ó —Å—Ö–µ–º–∏ PostgreSQL.